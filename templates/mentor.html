{% extends 'layout.html' %}

{% block head_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/dashboardCardsAd.css') }}">
<style>
    .sidebar {
        background: linear-gradient(180deg, #1e1b4b 0%, #312e81 100%);
    }

    /* Indigo Dark */
    .icon-admin {
        background: rgba(79, 70, 229, 0.1);
        color: #4f46e5;
    }
</style>
{% endblock %}

{% block titulo %}Administrar Mentores{% endblock %}

{% block contenido %}

<script src="https://cdn.tailwindcss.com"></script>

<div class="offcanvas-lg offcanvas-start sidebar position-fixed border-0" tabindex="-1" id="sidebarOffcanvas">
    <div class="d-flex flex-column h-100 p-3">
        <div class="py-5 text-center">
            <div
                class="bg-white/20 rounded-circle w-16 h-16 mx-auto mb-3 flex items-center justify-content-center border-2 border-white/50">
                <span class="text-white fw-bold text-2xl">A</span>
            </div>
            <h4 class="text-white fw-bold">AlliApp <small class="d-block text-xs opacity-75">Panel Admin</small></h4>
        </div>

        <ul class="nav nav-pills flex-column mb-auto">
            <li><a href="{{ url_for('dashboard_admin') }}" class="nav-link text-white"><i
                        class="fa-solid fa-chart-line me-3"></i> Inicio</a></li>
            <li><a href="{{ url_for('acciones_admin') }}" class="nav-link text-white"><i
                        class="fa-solid fa-gears me-3"></i> Acciones</a></li>
            <li><a href="{{ url_for('vista_mentores') }}" class="nav-link text-white"><i
                        class="fa-solid fa-user-tie me-3"></i> Mentores</a></li>
        </ul>

        <div class="p-3">
            <a href="{{ url_for('signout') }}" class="nav-link text-white opacity-70"><i
                    class="fa-solid fa-right-from-bracket me-3"></i> Salir</a>
        </div>
    </div>
</div>

<main class="main-content p-4 p-md-5">
        <header class="mb-10">
            <span class="text-green-600 font-semibold tracking-widest text-xs uppercase">Administrador de Sistema</span>
            <h1 class="text-4xl font-bold text-gray-800">Gestión de Mentores</h1>
            <p class="text-gray-500 mt-2">Asigna mentores a los proyectos y equipos disponibles.</p>
        </header>

        <div class="row">
            {% for mentor in mentores %}
            <div class="col-md-4 mb-4">
                <div class="card mentor-card h-100 shadow-sm border-0" style="cursor: pointer; border-radius: 15px;" 
                     data-bs-toggle="modal" data-bs-target="#modalMentor{{ mentor[0] }}">
                    <div class="card-body text-center p-5">
                        <div class="mentor-icon-container mb-4 mx-auto bg-light rounded-circle d-flex align-items-center justify-center" style="width: 80px; height: 80px;">
                            <i class="fas fa-user-tie fa-2x text-dark"></i>
                        </div>
                        <h5 class="fw-bold text-gray-800 mb-1">{{ mentor[1] }}</h5>
                        <p class="text-muted small mb-4">Código: {{ mentor[2] }}</p>
                        <button class="btn btn-outline-success btn-sm rounded-pill px-4">Asignar Equipo</button>
                    </div>
                </div>
            </div>

            <div class="modal fade" id="modalMentor{{ mentor[0] }}" tabindex="-1" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered">
                    <div class="modal-content border-0 shadow-lg" style="border-radius: 20px;">
                        <form action="{{ url_for('guardar_asignacion') }}" method="POST">
                            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                            <input type="hidden" name="id_mentor" value="{{ mentor[0] }}">
                            
                            <div class="modal-header bg-dark text-white p-4" style="border-radius: 20px 20px 0 0;">
                                <h5 class="modal-title font-bold">Asignar Equipo a {{ mentor[1] }}</h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body p-5">
                                <p class="text-muted mb-4">Selecciona un equipo de la lista para vincularlo con este mentor.</p>
                                <div class="mb-3">
                                    <label class="form-label font-bold text-gray-700">Equipo disponible</label>
                                    <select name="id_equipo" class="form-select form-select-lg border-2 shadow-sm" required>
                                        <option value="" selected disabled>Escoger equipo...</option>
                                        {% for equipo in equipos %}
                                        <option value="{{ equipo[0] }}">{{ equipo[1] }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <div class="modal-footer bg-light p-4" style="border-radius: 0 0 20px 20px;">
                                <button type="button" class="btn btn-light px-4" data-bs-dismiss="modal">Cerrar</button>
                                <button type="submit" class="btn btn-success px-5 font-bold">Confirmar Asignación</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </main>


{% endblock %}